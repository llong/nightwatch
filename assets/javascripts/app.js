!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):e.hasOwnProperty("angular")?t(e.angular):"object"==typeof exports&&(module.exports=t(require("angular")))}(this,function(e){"use strict";function t(e,t){var o;try{o=e[t]}catch(n){o=!1}if(o){var r="__"+Math.round(1e7*Math.random());try{e[t].setItem(r,r),e[t].removeItem(r,r)}catch(n){o=!1}}return o}function o(o){var n=t(window,o);return function(){var r="ngStorage-";this.setKeyPrefix=function(e){if("string"!=typeof e)throw new TypeError("[ngStorage] - "+o+"Provider.setKeyPrefix() expects a String.");r=e};var i=e.toJson,a=e.fromJson;this.setSerializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+o+"Provider.setSerializer expects a function.");i=e},this.setDeserializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+o+"Provider.setDeserializer expects a function.");a=e},this.supported=function(){return!!n},this.get=function(e){return n&&a(n.getItem(r+e))},this.set=function(e,t){return n&&n.setItem(r+e,i(t))},this.remove=function(e){n&&n.removeItem(r+e)},this.$get=["$rootScope","$window","$log","$timeout","$document",function(n,s,l,u,c){var p,h,d=r.length,f=t(s,o),g=f||(l.warn("This browser does not support Web Storage!"),{setItem:e.noop,getItem:e.noop,removeItem:e.noop}),m={$default:function(t){for(var o in t)e.isDefined(m[o])||(m[o]=e.copy(t[o]));return m.$sync(),m},$reset:function(e){for(var t in m)"$"===t[0]||delete m[t]&&g.removeItem(r+t);return m.$default(e)},$sync:function(){for(var e,t=0,o=g.length;o>t;t++)(e=g.key(t))&&r===e.slice(0,d)&&(m[e.slice(d)]=a(g.getItem(e)))},$apply:function(){var t;if(h=null,!e.equals(m,p)){t=e.copy(p),e.forEach(m,function(o,n){e.isDefined(o)&&"$"!==n[0]&&(g.setItem(r+n,i(o)),delete t[n])});for(var o in t)g.removeItem(r+o);p=e.copy(m)}},$supported:function(){return!!f}};return m.$sync(),p=e.copy(m),n.$watch(function(){h||(h=u(m.$apply,100,!1))}),s.addEventListener&&s.addEventListener("storage",function(t){if(t.key){var o=c[0];o.hasFocus&&o.hasFocus()||r!==t.key.slice(0,d)||(t.newValue?m[t.key.slice(d)]=a(t.newValue):delete m[t.key.slice(d)],p=e.copy(m),n.$apply())}}),s.addEventListener&&s.addEventListener("beforeunload",function(){m.$apply()}),m}]}}return e=e&&e.module?e:window.angular,e.module("ngStorage",[]).provider("$localStorage",o("localStorage")).provider("$sessionStorage",o("sessionStorage"))}),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="satellizer"),function(e,t,o){"use strict";e.location.origin||(e.location.origin=e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")),t.module("satellizer",[]).constant("SatellizerConfig",{httpInterceptor:function(){return!0},withCredentials:!1,tokenRoot:null,baseUrl:"/",loginUrl:"/auth/login",signupUrl:"/auth/signup",unlinkUrl:"/auth/unlink",tokenName:"token",tokenPrefix:"satellizer",authHeader:"Authorization",authToken:"Bearer",storageType:"localStorage",providers:{facebook:{name:"facebook",url:"/auth/facebook",authorizationEndpoint:"https://www.facebook.com/v2.5/dialog/oauth",redirectUri:e.location.origin+"/",requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",display:"popup",oauthType:"2.0",popupOptions:{width:580,height:400}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:e.location.origin,requiredUrlParams:["scope"],optionalUrlParams:["display","state"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633},state:function(){var e=Math.random().toString(36).substr(2);return encodeURIComponent(e)}},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",redirectUri:e.location.origin,optionalUrlParams:["scope"],scope:["user:email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",redirectUri:e.location.origin,requiredUrlParams:["scope"],scope:["basic"],scopeDelimiter:"+",oauthType:"2.0"},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/uas/oauth2/authorization",redirectUri:e.location.origin,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",state:"STATE",oauthType:"2.0",popupOptions:{width:527,height:582}},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",redirectUri:e.location.origin,oauthType:"1.0",popupOptions:{width:495,height:645}},twitch:{name:"twitch",url:"/auth/twitch",authorizationEndpoint:"https://api.twitch.tv/kraken/oauth2/authorize",redirectUri:e.location.origin,requiredUrlParams:["scope"],scope:["user_read"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",redirectUri:e.location.origin,requiredUrlParams:["display","scope"],scope:["wl.emails"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},yahoo:{name:"yahoo",url:"/auth/yahoo",authorizationEndpoint:"https://api.login.yahoo.com/oauth2/request_auth",redirectUri:e.location.origin,scope:[],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:559,height:519}},bitbucket:{name:"bitbucket",url:"/auth/bitbucket",authorizationEndpoint:"https://bitbucket.org/site/oauth2/authorize",redirectUri:e.location.origin+"/",requiredUrlParams:["scope"],scope:["email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1028,height:529}}}}).provider("$auth",["SatellizerConfig",function(e){Object.defineProperties(this,{httpInterceptor:{get:function(){return e.httpInterceptor},set:function(t){"function"==typeof t?e.httpInterceptor=t:e.httpInterceptor=function(){return t}}},baseUrl:{get:function(){return e.baseUrl},set:function(t){e.baseUrl=t}},loginUrl:{get:function(){return e.loginUrl},set:function(t){e.loginUrl=t}},signupUrl:{get:function(){return e.signupUrl},set:function(t){e.signupUrl=t}},tokenRoot:{get:function(){return e.tokenRoot},set:function(t){e.tokenRoot=t}},tokenName:{get:function(){return e.tokenName},set:function(t){e.tokenName=t}},tokenPrefix:{get:function(){return e.tokenPrefix},set:function(t){e.tokenPrefix=t}},unlinkUrl:{get:function(){return e.unlinkUrl},set:function(t){e.unlinkUrl=t}},authHeader:{get:function(){return e.authHeader},set:function(t){e.authHeader=t}},authToken:{get:function(){return e.authToken},set:function(t){e.authToken=t}},withCredentials:{get:function(){return e.withCredentials},set:function(t){e.withCredentials=t}},storageType:{get:function(){return e.storageType},set:function(t){e.storageType=t}}}),t.forEach(Object.keys(e.providers),function(o){this[o]=function(n){return t.extend(e.providers[o],n)}},this);var o=function(o){e.providers[o.name]=e.providers[o.name]||{},t.extend(e.providers[o.name],o)};this.oauth1=function(t){o(t),e.providers[t.name].oauthType="1.0"},this.oauth2=function(t){o(t),e.providers[t.name].oauthType="2.0"},this.$get=["$q","SatellizerShared","SatellizerLocal","SatellizerOauth",function(e,t,o,n){var r={};return r.login=function(e,t){return o.login(e,t)},r.signup=function(e,t){return o.signup(e,t)},r.logout=function(){return t.logout()},r.authenticate=function(e,t){return n.authenticate(e,t)},r.link=function(e,t){return n.authenticate(e,t)},r.unlink=function(e,t){return n.unlink(e,t)},r.isAuthenticated=function(){return t.isAuthenticated()},r.getToken=function(){return t.getToken()},r.setToken=function(e){t.setToken({access_token:e})},r.removeToken=function(){return t.removeToken()},r.getPayload=function(){return t.getPayload()},r.setStorageType=function(e){return t.setStorageType(e)},r}]}]).factory("SatellizerShared",["$q","$window","$log","SatellizerConfig","SatellizerStorage",function(n,r,i,a,s){var l={},u=a.tokenPrefix?[a.tokenPrefix,a.tokenName].join("_"):a.tokenName;return l.getToken=function(){return s.get(u)},l.getPayload=function(){var t=s.get(u);if(t&&3===t.split(".").length)try{var n=t.split(".")[1],r=n.replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(decodeURIComponent(escape(e.atob(r))))}catch(i){return o}},l.setToken=function(e){if(!e)return i.warn("Can't set token without passing a value");var o,n=e&&e.access_token;if(n&&(t.isObject(n)&&t.isObject(n.data)?e=n:t.isString(n)&&(o=n)),!o&&e){var r=a.tokenRoot&&a.tokenRoot.split(".").reduce(function(e,t){return e[t]},e.data);o=r?r[a.tokenName]:e.data&&e.data[a.tokenName]}if(!o){var l=a.tokenRoot?a.tokenRoot+"."+a.tokenName:a.tokenName;return i.warn('Expecting a token named "'+l)}s.set(u,o)},l.removeToken=function(){s.remove(u)},l.isAuthenticated=function(){var e=s.get(u);if(e){if(3===e.split(".").length)try{var t=e.split(".")[1],o=t.replace(/-/g,"+").replace(/_/g,"/"),n=JSON.parse(r.atob(o)).exp;if(n){var i=Math.round((new Date).getTime()/1e3)>=n;return!i}}catch(a){return!0}return!0}return!1},l.logout=function(){return s.remove(u),n.when()},l.setStorageType=function(e){a.storageType=e},l}]).factory("SatellizerOauth",["$q","$http","SatellizerConfig","SatellizerUtils","SatellizerShared","SatellizerOauth1","SatellizerOauth2",function(e,t,o,n,r,i,a){var s={};return s.authenticate=function(t,n){var s="1.0"===o.providers[t].oauthType?new i:new a,l=e.defer();return s.open(o.providers[t],n||{}).then(function(e){o.providers[t].url&&r.setToken(e,!1),l.resolve(e)})["catch"](function(e){l.reject(e)}),l.promise},s.unlink=function(e,r){return r=r||{},r.url=r.url?r.url:n.joinUrl(o.baseUrl,o.unlinkUrl),r.data={provider:e}||r.data,r.method=r.method||"POST",r.withCredentials=r.withCredentials||o.withCredentials,t(r)},s}]).factory("SatellizerLocal",["$http","SatellizerUtils","SatellizerShared","SatellizerConfig",function(e,t,o,n){var r={};return r.login=function(r,i){return i=i||{},i.url=i.url?i.url:t.joinUrl(n.baseUrl,n.loginUrl),i.data=r||i.data,i.method=i.method||"POST",i.withCredentials=i.withCredentials||n.withCredentials,e(i).then(function(e){return o.setToken(e),e})},r.signup=function(o,r){return r=r||{},r.url=r.url?r.url:t.joinUrl(n.baseUrl,n.signupUrl),r.data=o||r.data,r.method=r.method||"POST",r.withCredentials=r.withCredentials||n.withCredentials,e(r)},r}]).factory("SatellizerOauth2",["$q","$http","$window","$timeout","SatellizerPopup","SatellizerUtils","SatellizerConfig","SatellizerStorage",function(o,n,r,i,a,s,l,u){return function(){var r={},c={defaultUrlParams:["response_type","client_id","redirect_uri"],responseType:"code",responseParams:{code:"code",clientId:"clientId",redirectUri:"redirectUri"}};return r.open=function(n,l){c=s.merge(n,c);var p=o.defer();return i(function(){var o,n,i=c.name+"_state";t.isFunction(c.state)?u.set(i,c.state()):t.isString(c.state)&&u.set(i,c.state),o=[c.authorizationEndpoint,r.buildQueryString()].join("?"),n=e.cordova?a.open(o,c.name,c.popupOptions,c.redirectUri).eventListener(c.redirectUri):a.open(o,c.name,c.popupOptions,c.redirectUri).pollPopup(c.redirectUri),n.then(function(e){return"token"!==c.responseType&&c.url?e.state&&e.state!==u.get(i)?p.reject("The value returned in the state parameter does not match the state value from your original authorization code request."):void p.resolve(r.exchangeForToken(e,l)):p.resolve(e)},function(e){p.reject(e)})}),p.promise},r.exchangeForToken=function(e,o){var r=t.extend({},o);t.forEach(c.responseParams,function(t,o){switch(o){case"code":r[t]=e.code;break;case"clientId":r[t]=c.clientId;break;case"redirectUri":r[t]=c.redirectUri;break;default:r[t]=e[o]}}),e.state&&(r.state=e.state);var i=l.baseUrl?s.joinUrl(l.baseUrl,c.url):c.url;return n.post(i,r,{withCredentials:l.withCredentials})},r.buildQueryString=function(){var e=[],o=["defaultUrlParams","requiredUrlParams","optionalUrlParams"];return t.forEach(o,function(o){t.forEach(c[o],function(o){var n=s.camelCase(o),r=t.isFunction(c[o])?c[o]():c[n];if("redirect_uri"!==o||r){if("state"===o){var i=c.name+"_state";r=u.get(i)}"scope"===o&&Array.isArray(r)&&(r=r.join(c.scopeDelimiter),c.scopePrefix&&(r=[c.scopePrefix,r].join(c.scopeDelimiter))),e.push([o,encodeURIComponent(r)])}})}),e.map(function(e){return e.join("=")}).join("&")},r}}]).factory("SatellizerOauth1",["$q","$http","SatellizerPopup","SatellizerConfig","SatellizerUtils",function(o,n,r,i,a){return function(){var o={},s={url:null,name:null,popupOptions:null,redirectUri:null,authorizationEndpoint:null};return o.open=function(l,u){t.extend(s,l);var c,p=i.baseUrl?a.joinUrl(i.baseUrl,s.url):s.url;return e.cordova||(c=r.open("",s.name,s.popupOptions,s.redirectUri)),n.post(p,s).then(function(t){var n=[s.authorizationEndpoint,o.buildQueryString(t.data)].join("?");e.cordova?c=r.open(n,s.name,s.popupOptions,s.redirectUri):c.popupWindow.location=n;var i;return i=e.cordova?c.eventListener(s.redirectUri):c.pollPopup(s.redirectUri),i.then(function(e){return o.exchangeForToken(e,u)})})},o.exchangeForToken=function(e,o){var r=t.extend({},o,e),l=i.baseUrl?a.joinUrl(i.baseUrl,s.url):s.url;return n.post(l,r,{withCredentials:i.withCredentials})},o.buildQueryString=function(e){var o=[];return t.forEach(e,function(e,t){o.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}),o.join("&")},o}}]).factory("SatellizerPopup",["$q","$interval","$window","SatellizerConfig","SatellizerUtils",function(n,r,i,a,s){var l={};return l.url="",l.popupWindow=null,l.open=function(t,o,n){l.url=t;var r=l.stringifyOptions(l.prepareOptions(n)),a=i.navigator.userAgent,s=e.cordova||a.indexOf("CriOS")>-1?"_blank":o;return l.popupWindow=i.open(t,s,r),i.popup=l.popupWindow,l.popupWindow&&l.popupWindow.focus&&l.popupWindow.focus(),l},l.eventListener=function(e){var o=n.defer();return l.popupWindow.addEventListener("loadstart",function(n){if(0===n.url.indexOf(e)){var r=document.createElement("a");if(r.href=n.url,r.search||r.hash){var i=r.search.substring(1).replace(/\/$/,""),a=r.hash.substring(1).replace(/\/$/,""),u=s.parseQueryString(a),c=s.parseQueryString(i);t.extend(c,u),c.error||o.resolve(c),l.popupWindow.close()}}}),l.popupWindow.addEventListener("loaderror",function(){o.reject("Authorization Failed")}),o.promise},l.pollPopup=function(e){var i=n.defer(),a=document.createElement("a");a.href=e;var u=s.getFullUrlPath(a),c=r(function(){l.popupWindow&&!l.popupWindow.closed&&l.popupWindow.closed!==o||(i.reject("The popup window was closed."),r.cancel(c));try{var e=s.getFullUrlPath(l.popupWindow.location);if(e===u){if(l.popupWindow.location.search||l.popupWindow.location.hash){var n=l.popupWindow.location.search.substring(1).replace(/\/$/,""),a=l.popupWindow.location.hash.substring(1).replace(/[\/$]/,""),p=s.parseQueryString(a),h=s.parseQueryString(n);t.extend(h,p),h.error?i.reject(h):i.resolve(h)}else i.reject("Redirect has occurred but no query or hash parameters were found. They were either not set during the redirect, or were removed before Satellizer could read them, e.g. AngularJS routing mechanism.");r.cancel(c),l.popupWindow.close()}}catch(d){}},20);return i.promise},l.prepareOptions=function(e){e=e||{};var o=e.width||500,n=e.height||500;return t.extend({width:o,height:n,left:i.screenX+(i.outerWidth-o)/2,top:i.screenY+(i.outerHeight-n)/2.5},e)},l.stringifyOptions=function(e){var o=[];return t.forEach(e,function(e,t){o.push(t+"="+e)}),o.join(",")},l}]).service("SatellizerUtils",function(){this.getFullUrlPath=function(e){var t="https:"===e.protocol;return e.protocol+"//"+e.hostname+":"+(e.port||(t?"443":"80"))+(/^\//.test(e.pathname)?e.pathname:"/"+e.pathname)},this.camelCase=function(e){return e.replace(/([\:\-\_]+(.))/g,function(e,t,o,n){return n?o.toUpperCase():o})},this.parseQueryString=function(e){var o,n,r={};return t.forEach((e||"").split("&"),function(e){e&&(n=e.split("="),o=decodeURIComponent(n[0]),r[o]=t.isDefined(n[1])?decodeURIComponent(n[1]):!0)}),r},this.joinUrl=function(e,t){if(/^(?:[a-z]+:)?\/\//i.test(t))return t;var o=[e,t].join("/"),n=function(e){return e.replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")};return n(o)},this.merge=function(e,t){var o={};for(var n in e)e.hasOwnProperty(n)&&(n in t&&"object"==typeof e[n]&&null!==n?o[n]=this.merge(e[n],t[n]):o[n]=e[n]);for(n in t)if(t.hasOwnProperty(n)){if(n in o)continue;o[n]=t[n]}return o}}).factory("SatellizerStorage",["$window","$log","SatellizerConfig",function(e,t,o){var n={},r=function(){try{var t=o.storageType in e&&null!==e[o.storageType];if(t){var n=Math.random().toString(36).substring(7);e[o.storageType].setItem(n,""),e[o.storageType].removeItem(n)}return t}catch(r){return!1}}();return r||t.warn(o.storageType+" is not available."),{get:function(t){return r?e[o.storageType].getItem(t):n[t]},set:function(t,i){return r?e[o.storageType].setItem(t,i):n[t]=i},remove:function(t){return r?e[o.storageType].removeItem(t):delete n[t]}}}]).factory("SatellizerInterceptor",["$q","SatellizerConfig","SatellizerStorage","SatellizerShared",function(e,t,o,n){return{request:function(e){if(e.skipAuthorization)return e;if(n.isAuthenticated()&&t.httpInterceptor(e)){var r=t.tokenPrefix?t.tokenPrefix+"_"+t.tokenName:t.tokenName,i=o.get(r);t.authHeader&&t.authToken&&(i=t.authToken+" "+i),e.headers[t.authHeader]=i}return e},responseError:function(t){return e.reject(t)}}}]).config(["$httpProvider",function(e){e.interceptors.push("SatellizerInterceptor")}])}(window,window.angular);var app=angular.module("app",["ngRoute","ngStorage","satellizer"]);app.value("API","https://portaldev.nightwatch24.com:44433/"),app.config(["$routeProvider","$locationProvider","$authProvider",function(e,t,o){o.loginUrl="https://portaldev.nightwatch24.com:44433/api/login",o.tokenName="access_token",e.when("/",{templateUrl:"assets/partials/dashboard.html",controller:"dashboardController",activetab:"dashboard"}).when("/login",{templateUrl:"assets/partials/login.html",controller:"loginController as login"}).when("/register",{templateUrl:"assets/partials/register.html",controller:"registerController"}).when("/create-name-password",{templateUrl:"assets/partials/create-name-password.html"}).when("/add-phone",{templateUrl:"assets/partials/add-phone.html",controller:"phoneController as phone"}).when("/primary-address",{templateUrl:"assets/partials/primary-address.html"}).when("/billing-address",{templateUrl:"assets/partials/billing-address.html"}).when("/create-subaccount",{templateUrl:"assets/partials/create-subaccount.html"}).when("/create-group",{templateUrl:"assets/partials/create-group.html"}).when("/add-device",{templateUrl:"assets/partials/add-device.html",controller:"deviceController as device"}).when("/add-horse",{templateUrl:"assets/partials/add-horse.html",controller:"horseController"}).when("/notification-settings",{templateUrl:"assets/partials/notification-settings.html"}).when("/user",{templateUrl:"assets/partials/user.html",controller:"userController as user"}).when("/devices",{templateUrl:"assets/partials/devices.html",controller:"deviceController as device",activetab:"devices"}).when("/horses",{templateUrl:"assets/partials/horses.html",controller:"horseController as horse",activetab:"horses"}).when("/horses/:id",{templateUrl:"assets/partials/horse.html",controller:"horseController as horse",activetab:"horses"}).otherwise({redirectTo:"/login"})}]),app.run(["$http",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.defaults.headers.common.Accept="application/json;odata=verbose"}]),app.factory("authenticate",function(){var e="https://portaldev.nightwatch24.com:44433/";return e}),app.factory("horseService",["$http",function(e){var t="https://portaldev.nightwatch24.com:44433/",o={async:function(){var o=e.get(t+"/api/horse").then(function(e){return e.data});return o}};return o}]),app.factory("countries",["$http","API",function(e,t){var t=t,o={};return o.getCountries=function(){return e.get(t+"api/country/optList")},o}]),app.controller("dashboardController",["$scope","$http","$localStorage","$location","API","$route",function(e,t,o,n,r,i){var r=r;e.$route=i,e.sortType="edi_score",e.sortReverse=!0;var a=function(){t.get(r+"/api/horse").then(function(t){e.horses=t.data,console.log(e.horses),e.serialNumber="",e.nickName=""})["catch"](function(e){if(401===e.status||null==localStorage)throw n.path("/login"),e;console.log("all good")})["finally"](function(){e.loading=!1})};a(),e.ediColor=function(e){return e.edi_score<4?"label-success":e.edi_score<6?"label-warning":"label-danger"},e.loading=!0,e.getHorse=function(o){e.activeHorse=o,console.log(o),console.log(e.activeHorse),t.get(r+"/api/horse/"+o.id+"/metric/latest").then(function(t){e.metrics=t.data,console.log(e.metrics)})["catch"](function(e){console.log(e)})["finally"](function(){e.loading=!1})}}]),app.controller("deviceController",["$scope","$http","$localStorage","$location","API","$route",function(e,t,o,n,r,i){var r=r;e.regex=/^[a-zA-Z0-9]{12}?/,e.$route=i;var a=this;t.get(r+"api/device").then(function(e){a.devices=e.data,console.log(a.devices)})["catch"](function(e){401===e.status&&n.path("/login"),console.log(e)}),e.successMessage=!1,a.addDevice=function(){t.post(r+"api/device",{serialNumber:a.serialNumber,nickName:a.nickName}).then(function(e){a.successMessage=!0,a.serialNumber="",a.nickName=""})["catch"](function(e){throw e})["finally"](function(e){t.get(r+"api/device").then(function(e){a.devices=e.data})})}}]),app.controller("groupController",["$scope",function(e){e.group=!1,e.groups=[],e.assignGroupLink="",e.assignGroup=function(){e.group?(e.group=!1,this.innerHTML="Don't Assign Address To Group"):(e.group=!0,this.innerHTML="Don't Assign Address To Group")},e.addGroup=function(){e.groups.push({groupName:e.groupName,address:e.address,address2:e.address2,city:e.city,state:e.state,country:e.country}),e.groupName="",e.address="",e.address2="",e.city="",e.state="",e.country="",e.group=!1}}]),app.controller("horseController",["$scope","$http","$localStorage","$location","API","$route","$routeParams",function(e,t,o,n,r,i,a){var r=r,s=this;s.loading=!0,e.$route=i,s.getHorses=function(){t.get(r+"api/horse").then(function(e){s.horses=e.data,s.whichHorse=a.id})["catch"](function(e){401===e.status&&n.path("/login")})["finally"](function(){s.loading=!1})},s.getHorses(),e.addHorse=function(){t.post(r+"api/horse",{registeredName:e.registeredName,nickName:e.nickName,sex:e.sex,breed:e.breed}).then(function(t){e.horses=t,console.log(t),e.horseForm=null},function(e){console.log(e)})}}]),app.controller("loginController",["$scope","$auth","$location","API",function(e,t,o,n){var r=this;e.loggingIn=!1,r.login=function(){e.loggingIn=!0;var n={username:r.username,password:r.password};t.login(n).then(function(t){e.loggingIn=!0,o.path("/")})["catch"](function(t){401==t.status&&(e.invalidPassword=!0)})["finally"](function(){e.loggingIn=!1})}}]),app.controller("mainController",["$scope","$http","$localStorage","$location","authenticate","API",function(e,t,o,n,r,i){console.log(i),e.getData=function(){t.get(i+"api/account",{}).then(function(t){e.userData=t.data,console.log(e.userData)})},e.toggleMenu=function(){e.expanded=!e.expanded},e.userMenu=function(){e.userExpanded=!e.userExpanded,console.log("click")},e.signOut=function(){localStorage.clear(),n.path("/login"),console.log("sign out")}}]),app.controller("phoneController",["$http","countries","API","$location",function(e,t,o,n){var o=o,r=this;t.getCountries().then(function(e){r.countries=e.data}),r.getPhones=function(){e.get(o+"api/account/contact/phones").then(function(e){r.phones=e.data,console.log(e.data),r.loadingPhones=!0})["finally"](function(){r.loadingPhones=!1})},r.getPhones(),r.addPhone=function(){e.post(o+"api/account/contact/phones",{countryCode:r.code,areaCode:r.areaCode,number:r.number}).then(function(){console.log("success"),r.successMessage=!0,r.errorMessage=!1,r.code="",r.areaCode="",r.number=""})["catch"](function(e){401==e.status?$locaiton.path("/login"):422==e.status&&(r.errorMessage=!0,r.successMessage=!1,r.errors=e.data.errors)})["finally"](function(){r.getPhones()})},r.deletePhone=function(t){e["delete"](t.uri).then(function(t){e.get(o+"api/account/contact/phones"),console.log("delete phone")})["catch"](function(e){throw e})["finally"](function(){r.getPhones(),console.log("phone removed")})}}]),app.controller("registerController",["$scope","$http","API",function(e,t,o){var o=o;e.register=function(n,r){e.password===e.password2&&t.post(o+"account/register",{username:e.username,email:e.email,salutation:e.salutation,firstName:e.firstName,lastName:e.lastName,password:e.password,password2:e.password2}).then(function(e){console.log(e)})}}]),app.controller("userController",["$scope","$http","API","$location","countries",function(e,t,o,n,r){var o=o,i=this;r.getCountries().then(function(e){i.countries=e.data}),i.user={},t.get(o+"/api/account/contact").then(function(e){i.profile=e.data[0],console.log(i.profile)})["catch"](function(e){e&&n.path("/login")})["finally"](function(){}),i.updateProfile=function(){t.put(o+"/api/account/contact",{title:i.profile.title,first_name:i.profile.first_name,last_name:i.profile.last_name})["catch"](function(e){throw e})["finally"](function(){alert("success")})};var a=function(){t.get(o+"/api/account/contact/emails").then(function(t){i.emails=t.data,console.log(i.emails),e.loadingEmails=!0})["catch"](function(e){401===e.status&&n.path("/login")})["finally"](function(){e.loadingEmails=!1})};a(),i.addEmail=function(){t.post(o+"/api/account/contact/emails",{emailAddress:i.emailAddress}).then(function(){i.loadingEmails=!0})["catch"](function(e){throw e})["finally"](function(){a()})};i.deleteEmail=function(e){t["delete"](e.uri).then(function(){a()})},e.showUserForm=function(){e.skipButton=!1,e.AddUserForm=!0,console.log("click")}}]);